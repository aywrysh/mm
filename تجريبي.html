<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â€“ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>

  <!-- Ø®Ø· ÙˆØ£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¬ÙˆØ¬Ù„ -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,600,0,0" rel="stylesheet">

  <style>
    :root{
      --accent:#BBCF38;
      --accent-2:#89A61B;

      /* Light System */
      --bg:#f6f7fb;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#64748b;
      --line:rgba(15,23,42,.10);

      --radius:18px;
      --shadow-lg:0 18px 40px rgba(2,6,23,.10);
      --shadow-md:0 10px 24px rgba(2,6,23,.08);
      --glow:0 0 0 6px rgba(187,207,56,.18);

      --chip: rgba(15,23,42,.06);
      --chip-2: rgba(187,207,56,.16);

      /* Ø«ÙŠÙ…Ø§Øª */
      --bg-grad-1: rgba(187,207,56,.22);
      --bg-grad-2: rgba(15,23,42,.08);
      --body-start:#ffffff;
    }

    /* âœ… Ø«ÙŠÙ… Ø¯Ø§ÙƒÙ† (ÙŠØ­ÙØ¸ ÙˆÙŠØ·Ø¨Ù‘Ù‚) */
    html[data-theme="dark"]{
      --bg:#0b1220;
      --card:rgba(17,24,39,.92);
      --ink:#e5e7eb;
      --muted:#94a3b8;
      --line:rgba(255,255,255,.10);

      --shadow-lg:0 18px 40px rgba(0,0,0,.35);
      --shadow-md:0 10px 24px rgba(0,0,0,.25);

      --chip: rgba(255,255,255,.08);
      --chip-2: rgba(187,207,56,.14);

      --bg-grad-1: rgba(187,207,56,.18);
      --bg-grad-2: rgba(255,255,255,.06);
      --body-start:#0b1220;
    }

    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Cairo",system-ui,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink);
      background:
        radial-gradient(900px 420px at 95% -10%, var(--bg-grad-1) 0%, transparent 60%),
        radial-gradient(700px 360px at -10% 110%, var(--bg-grad-2) 0%, transparent 60%),
        linear-gradient(180deg, var(--body-start) 0%, var(--bg) 100%);
    }

    .ms{font-family:'Material Symbols Rounded'; line-height:1}

    /* Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ */
    .topbar{
      position:sticky; top:0; z-index:30;
      backdrop-filter:saturate(150%) blur(12px);
      background:rgba(255,255,255,.72);
      border-bottom:1px solid var(--line);
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 14px;
    }
    html[data-theme="dark"] .topbar{
      background:rgba(15,23,42,.65);
    }

    .brand{display:flex; align-items:center; gap:10px; font-weight:900}
    .dot{
      width:12px;height:12px;border-radius:50%;
      background:linear-gradient(180deg,var(--accent),var(--accent-2));
      box-shadow:0 0 0 4px rgba(187,207,56,.22);
    }
    .top-actions{display:flex;gap:8px}

    .btn{
      width:40px;height:40px; display:grid; place-items:center; cursor:pointer;
      border:1px solid var(--line); border-radius:12px;
      background:rgba(255,255,255,.75);
      box-shadow:0 8px 16px rgba(2,6,23,.06);
      transition:transform .08s ease, box-shadow .2s ease, border-color .2s ease;
    }
    html[data-theme="dark"] .btn{
      background:rgba(255,255,255,.06);
      box-shadow:0 8px 16px rgba(0,0,0,.25);
    }
    .btn:hover{border-color:rgba(187,207,56,.35); box-shadow:0 12px 26px rgba(2,6,23,.10), var(--glow)}
    .btn:active{transform:translateY(1px)}

    /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
    .container{max-width:1200px; margin:0 auto; padding:22px 14px 96px}

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
    .hero{
      position:relative;
      border-radius:calc(var(--radius) + 4px);
      padding:26px 22px 18px;
      background:
        radial-gradient(260px 160px at 10% 0%, rgba(187,207,56,.20), transparent 60%),
        radial-gradient(280px 170px at 95% -10%, rgba(15,23,42,.06), transparent 65%),
        var(--card);
      border:1px solid rgba(15,23,42,.08);
      box-shadow:var(--shadow-lg);
      display:grid; gap:10px; text-align:center; overflow:hidden; isolation:isolate;
      color:var(--ink);
    }
    html[data-theme="dark"] .hero{
      border:1px solid rgba(255,255,255,.10);
    }
    .hero h1{margin:0; font-size:28px; font-weight:900; letter-spacing:.2px}
    .hero .hint{color:var(--muted); font-size:14px; font-weight:800}

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù‡ÙŠØ±Ùˆ */
    .hero-actions{
      display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
      margin-top:6px;
    }
    .hero-cta{
      display:inline-flex; align-items:center; gap:8px;
      padding:12px 18px; border-radius:14px; font-weight:900; text-decoration:none;
      background:linear-gradient(180deg, var(--accent), var(--accent-2));
      color:#0b120f;
      border:1px solid rgba(2,6,23,.12);
      box-shadow:0 14px 28px rgba(187,207,56,.28), 0 0 0 5px rgba(187,207,56,.16);
      transition:transform .1s ease, box-shadow .2s ease, filter .2s ease;
    }
    .hero-cta .ms{font-size:20px}
    .hero-cta:hover{ box-shadow:0 18px 40px rgba(187,207,56,.34), 0 0 0 7px rgba(187,207,56,.16); filter:saturate(112%) }
    .hero-cta:active{ transform:translateY(1px) }

    .hero-ghost{
      display:inline-flex; align-items:center; gap:8px;
      padding:12px 18px; border-radius:14px; font-weight:900; text-decoration:none;
      background:rgba(255,255,255,.80);
      color:var(--ink);
      border:1px solid rgba(15,23,42,.10);
      box-shadow:0 10px 22px rgba(2,6,23,.08);
      transition:transform .1s ease, box-shadow .2s ease, border-color .2s ease;
    }
    html[data-theme="dark"] .hero-ghost{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      box-shadow:0 10px 22px rgba(0,0,0,.25);
    }
    .hero-ghost .ms{font-size:20px; color:var(--accent-2)}
    .hero-ghost:hover{
      border-color:rgba(187,207,56,.45);
      box-shadow:0 14px 28px rgba(2,6,23,.10), var(--glow);
    }
    .hero-ghost:active{ transform:translateY(1px) }

    /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
    .section{
      margin-top:16px; border-radius:18px; padding:14px;
      background:var(--card);
      border:1px solid rgba(15,23,42,.08);
      box-shadow:var(--shadow-md);
    }
    html[data-theme="dark"] .section{
      border:1px solid rgba(255,255,255,.10);
    }
    .section h2{
      margin:0 0 10px;
      font-size:16px; font-weight:900;
      color:var(--ink);
      display:flex; align-items:center; gap:8px;
    }

    .rows{display:grid;gap:10px}
    .row{
      display:flex; align-items:center; gap:10px; padding:12px 12px;
      border:1px solid rgba(15,23,42,.08); border-radius:14px;
      background:linear-gradient(180deg, rgba(255,255,255,.95), rgba(246,247,251,.75));
      box-shadow:0 10px 18px rgba(2,6,23,.06);
    }
    html[data-theme="dark"] .row{
      border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow:0 10px 18px rgba(0,0,0,.25);
    }
    .row .ms{
      color:var(--accent-2);
      background:rgba(187,207,56,.16);
      border:1px solid rgba(187,207,56,.24);
      width:38px;height:38px;border-radius:12px;
      display:grid; place-items:center;
      font-size:22px;
    }
    .row .name{font-weight:900}
    .row .sep{color:#94a3b8}
    .row .amt{font-weight:900; color:var(--ink)}
    .badge{
      padding:4px 10px; border-radius:999px;
      border:1px solid rgba(15,23,42,.10);
      background:var(--chip);
      font-weight:900; font-size:12px; color:var(--muted)
    }
    html[data-theme="dark"] .badge{
      border:1px solid rgba(255,255,255,.10);
    }

    .users{display:grid;gap:10px}
    .empty{
      display:none; text-align:center; color:var(--muted); font-weight:900;
      padding:12px; border:1px dashed rgba(15,23,42,.18);
      border-radius:14px; background:rgba(255,255,255,.7)
    }
    html[data-theme="dark"] .empty{
      border:1px dashed rgba(255,255,255,.18);
      background:rgba(255,255,255,.04);
    }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    .grid{ margin-top:16px; display:grid; gap:14px; grid-template-columns:repeat(4, minmax(0, 1fr)); }
    @media (max-width:1100px){ .grid{grid-template-columns:repeat(3, 1fr);} }
    @media (max-width:780px) { .grid{grid-template-columns:repeat(2, 1fr);} }
    @media (max-width:480px) { .grid{grid-template-columns:1fr;} }

    .tile{
      position:relative; overflow:hidden; cursor:pointer; isolation:isolate;
      background:var(--card);
      border:1px solid rgba(15,23,42,.10);
      border-radius:20px; padding:18px;
      display:flex; align-items:center; gap:12px;
      box-shadow:var(--shadow-md);
      color:var(--ink); text-decoration:none;
      transition:transform .15s ease, border-color .2s ease, box-shadow .2s ease, background .2s ease;
    }
    html[data-theme="dark"] .tile{
      border:1px solid rgba(255,255,255,.10);
    }
    .tile:hover{
      transform:translateY(-3px);
      border-color:rgba(187,207,56,.45);
      box-shadow:0 18px 40px rgba(2,6,23,.12), 0 0 0 6px rgba(187,207,56,.12);
      background:
        radial-gradient(140px 80px at 95% -20%, rgba(187,207,56,.22), transparent 60%),
        var(--card);
    }
    html[data-theme="dark"] .tile:hover{
      box-shadow:0 18px 40px rgba(0,0,0,.35), 0 0 0 6px rgba(187,207,56,.10);
      background:
        radial-gradient(140px 80px at 95% -20%, rgba(187,207,56,.16), transparent 60%),
        var(--card);
    }
    .tile:active{ transform:translateY(-1px) scale(.995); }

    .tile .icon{
      width:54px;height:54px; min-width:54px; border-radius:18px;
      background:linear-gradient(180deg, rgba(15,23,42,.06), rgba(15,23,42,.02));
      border:1px solid rgba(15,23,42,.10);
      display:grid; place-items:center;
      box-shadow:inset 0 1px 0 rgba(255,255,255,.7);
    }
    html[data-theme="dark"] .tile .icon{
      border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow:inset 0 1px 0 rgba(255,255,255,.08);
    }
    .tile .icon .ms{font-size:28px; color:var(--accent-2)}
    .tile .text{display:grid; gap:2px}
    .tile .title{font-weight:900; font-size:18px; color:var(--ink)}
    .tile .desc{font-size:12px; color:var(--muted); font-weight:800}
    .right{margin-inline-start:auto; color:#94a3b8; display:flex; align-items:center; gap:8px}
    .chip{
      font-weight:900; font-size:11px;
      padding:5px 10px; border-radius:999px;
      border:1px solid rgba(15,23,42,.10);
      background:rgba(15,23,42,.04);
      color:var(--muted);
    }
    html[data-theme="dark"] .chip{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.06);
    }
    .chip-accent{
      border-color:rgba(187,207,56,.55);
      background:var(--chip-2);
      color:#2f3a05;
    }
    html[data-theme="dark"] .chip-accent{
      color:#eaf5a9;
    }

    /* Ripple */
    .ripple{position:absolute;border-radius:50%;transform:scale(0);background:rgba(2,6,23,.10);animation:ripple .6s linear;pointer-events:none}
    html[data-theme="dark"] .ripple{background:rgba(255,255,255,.14)}
    @keyframes ripple{to{transform:scale(3);opacity:0}}

    /* Ø²Ø± Ø·Ø§ÙÙ */
    .fab{
      position:fixed; inset-inline-end:18px; bottom:18px; z-index:40;
      width:62px; height:62px; border-radius:20px; display:grid; place-items:center;
      background:linear-gradient(180deg, var(--accent), var(--accent-2)); color:#0b120f;
      border:1px solid rgba(2,6,23,.14);
      box-shadow:0 18px 44px rgba(187,207,56,.28), 0 0 0 7px rgba(187,207,56,.14);
      cursor:pointer; text-decoration:none; font-weight:900;
      transition:transform .1s ease, box-shadow .2s ease, filter .2s ease;
    }
    .fab:hover{ box-shadow:0 24px 56px rgba(187,207,56,.34), 0 0 0 9px rgba(187,207,56,.14); filter:saturate(112%) }
    .fab:active{ transform:translateY(1px) }
    .fab .ms{font-size:26px}
    .fab-label{
      position:fixed; inset-inline-end:92px; bottom:28px; z-index:40;
      background:rgba(255,255,255,.75);
      border:1px solid rgba(15,23,42,.10);
      padding:8px 12px; border-radius:12px;
      font-weight:900; color:var(--ink);
      backdrop-filter:blur(10px);
      box-shadow:0 14px 28px rgba(2,6,23,.10);
    }
    html[data-theme="dark"] .fab-label{
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 14px 28px rgba(0,0,0,.35);
    }

    /* ØªÙˆØ³Øª */
    #toast{
      position:fixed;bottom:24px;left:50%;
      transform:translateX(-50%) scale(.96);
      background:rgba(15,23,42,.92);
      color:#fff;padding:8px 12px;border-radius:12px;
      font-weight:900;font-size:12px;opacity:0;pointer-events:none;
      transition:.25s;z-index:70
    }
    #toast.show{opacity:1;transform:translateX(-50%) scale(1)}

    /* âœ… Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø«ÙŠÙ… */
    .theme-modal{
      position:fixed; inset:0; z-index:90;
      display:none; align-items:center; justify-content:center;
      background:rgba(2,6,23,.35);
      padding:16px;
    }
    .theme-modal.show{display:flex}
    .theme-panel{
      width:min(420px, 96vw);
      background:var(--card);
      border:1px solid rgba(15,23,42,.10);
      border-radius:18px;
      box-shadow:0 22px 60px rgba(2,6,23,.22);
      overflow:hidden;
    }
    html[data-theme="dark"] .theme-panel{
      border:1px solid rgba(255,255,255,.10);
      box-shadow:0 22px 60px rgba(0,0,0,.55);
    }
    .theme-head{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 14px;
      border-bottom:1px solid var(--line);
    }
    .theme-head .t{font-weight:900}
    .theme-body{padding:14px; display:grid; gap:10px}
    .theme-opt{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px 12px; border-radius:14px;
      border:1px solid rgba(15,23,42,.10);
      background:rgba(255,255,255,.65);
      cursor:pointer;
      font-weight:900;
    }
    html[data-theme="dark"] .theme-opt{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.05);
    }
    .theme-opt:hover{
      border-color:rgba(187,207,56,.45);
      box-shadow:0 0 0 6px rgba(187,207,56,.12);
    }
    .theme-opt .l{display:flex; align-items:center; gap:10px}
    .theme-opt .b{
      width:14px;height:14px;border-radius:999px;
      border:2px solid rgba(15,23,42,.25);
    }
    html[data-theme="dark"] .theme-opt .b{border-color:rgba(255,255,255,.25)}
    .theme-opt.active .b{
      border-color:rgba(187,207,56,.85);
      box-shadow:0 0 0 5px rgba(187,207,56,.18) inset;
      background:rgba(187,207,56,.45);
    }
    .theme-foot{
      padding:12px 14px;
      border-top:1px solid var(--line);
      display:flex; gap:10px; justify-content:flex-start; flex-wrap:wrap;
      background:rgba(255,255,255,.55);
    }
    html[data-theme="dark"] .theme-foot{background:rgba(255,255,255,.03)}
    .theme-btn{
      padding:10px 14px; border-radius:12px;
      border:1px solid rgba(15,23,42,.10);
      background:rgba(255,255,255,.8);
      cursor:pointer; font-weight:900;
    }
    html[data-theme="dark"] .theme-btn{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.06);
      color:var(--ink);
    }
  </style>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#BBCF38">
</head>
<body>

  <!-- Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ Ù…Ø®ØªØµØ± -->
  <header class="topbar">
    <div class="brand"><span class="dot"></span><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
    <div class="top-actions">
      <button class="btn" id="refreshBtn" title="ØªØ­Ø¯ÙŠØ«"><span class="ms">refresh</span></button>

      <!-- âœ… Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙ‚Ø· (Ø«ÙŠÙ…) -->
      <button class="btn" id="settingsBtn" title="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª / Ø§Ù„Ø«ÙŠÙ…"><span class="ms">settings</span></button>

      <button class="btn" id="helpBtn" title="Ù…Ø³Ø§Ø¹Ø¯Ø©"><span class="ms">help</span></button>
    </div>
  </header>

  <main class="container">
    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
    <section class="hero">
      <h1>Ù„ÙˆØ­Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø´Ø±ÙƒØ©</h1>
      <div class="hint">Ø§Ø®ØªØ± Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥Ø¯Ø§Ø±ØªÙ‡Ø§ Ø¨Ø³Ø±Ø¹Ø©.</div>

      <!-- Ø£Ø²Ø±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‡ÙŠØ±Ùˆ -->
      <div class="hero-actions">
        <!-- Ø²Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‡ÙŠØ±Ùˆ -->
        <a class="hero-cta ripple-container" href="index13.html" id="ctaCreateAnn">
          <span class="ms">campaign</span>
          <span>Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯</span>
        </a>

        <!-- âœ… Ø²Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª -->
        <a class="hero-ghost ripple-container" href="index14.html" id="ctaAccounts">
          <span class="ms">manage_accounts</span>
          <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</span>
        </a>

        <!-- âœ… (ØªÙ… Ø¥Ù†Ø²Ø§Ù„ Ø²Ø± ØªÙˆÙ‚ÙŠÙ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª + Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª Ø¥Ù„Ù‰ Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ø²Ø±Ø§Ø± ØªØ­Øª) -->
      </div>
    </section>

    <!-- ğŸ”´ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Firebase (Ù†ÙØ³ Ø±Ø¨Ø· ØµÙØ­ØªÙƒ) -->
    <section class="section" id="liveStats">
      <h2>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©</h2>
      <div id="metrics" class="rows"></div>
      <div id="empty1" class="empty">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§ Ø§Ù„Ø¢Ù†.</div>
    </section>

    <section class="section">
      <h2>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† <span id="newCount" class="badge">0</span></h2>
      <div id="newUsers" class="users"></div>
      <div id="empty2" class="empty">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¬Ø¯Ø¯.</div>
    </section>

    <!-- Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ø²Ø±Ø§Ø± (Ø±ÙˆØ§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø±Ø©) -->
    <section class="grid">
      <a class="tile ripple-container" href="index2.html">
        <div class="icon"><span class="ms">account_balance_wallet</span></div>
        <div class="text"><div class="title">Ø¥ÙŠØ¯Ø§Ø¹</div><div class="desc">ØªØ³Ø¬ÙŠÙ„ ÙˆÙ…Ø¹Ø§ÙŠÙ†Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹</div></div>
        <div class="right"><span class="chip">Ø¬Ø¯ÙŠØ¯</span><span class="ms">chevron_left</span></div>
      </a>

      <a class="tile ripple-container" href="index3.html">
        <div class="icon"><span class="ms">payments</span></div>
        <div class="text"><div class="title">Ø³Ø­Ø¨</div><div class="desc">Ø¥Ø¯Ø§Ø±Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ø¹ØªÙ…Ø§Ø¯Ù‡Ø§</div></div>
        <div class="right"><span class="chip">Ù…Ø±Ø§Ø¬Ø¹Ø©</span><span class="ms">chevron_left</span></div>
      </a>

      <a class="tile ripple-container" href="index4.html">
        <div class="icon"><span class="ms">sync_alt</span></div>
        <div class="text"><div class="title">ØªØ­ÙˆÙŠÙ„</div><div class="desc">Ù…Ù† Ø­Ø³Ø§Ø¨ Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¢Ø®Ø±</div></div>
        <div class="right"><span class="chip">Ù†Ø´Ø·</span><span class="ms">chevron_left</span></div>
      </a>

      <a class="tile ripple-container" href="index5.html">
        <div class="icon"><span class="ms">account_tree</span></div>
        <div class="text"><div class="title">Ù‚ÙŠÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„</div><div class="desc">Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…Ù‚ÙÙ„</div></div>
        <div class="right"><span class="chip">Ø¹Ø±Ø¶</span><span class="ms">chevron_left</span></div>
      </a>

      <a class="tile ripple-container" href="index6.html">
        <div class="icon"><span class="ms">person_add</span></div>
        <div class="text"><div class="title">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</div><div class="desc">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…</div></div>
        <div class="right"><span class="chip">Ø¥Ø¯Ø§Ø±Ø©</span><span class="ms">chevron_left</span></div>
      </a>

      <a class="tile ripple-container" href="index7.html">
        <div class="icon"><span class="ms">send</span></div>
        <div class="text"><div class="title">Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©</div><div class="desc">Ø¥Ø´Ø¹Ø§Ø± Ø£Ùˆ ØªÙ†Ø¨ÙŠÙ‡</div></div>
        <div class="right"><span class="chip">Ø³Ø±ÙŠØ¹</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø£Ø¯Ù…Ù†) -->
      <a class="tile ripple-container" href="index8.html">
        <div class="icon"><span class="ms">manage_search</span></div>
        <div class="text"><div class="title">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</div><div class="desc">Ø¨Ø­Ø« ÙˆÙ†Ø³Ø® Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</div></div>
        <div class="right"><span class="chip">Ø£Ø¯Ù…Ù†</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª: Ù‚Ø§Ø¦Ù…Ø© ÙˆÙ…Ø±Ø§Ø¬Ø¹Ø© -->
      <a class="tile ripple-container" href="index9.html">
        <div class="icon"><span class="ms">list_alt</span></div>
        <div class="text"><div class="title">Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª</div><div class="desc">Ø³Ø¬Ù„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª ÙˆØ§Ø¹ØªÙ…Ø§Ø¯Ù‡Ø§</div></div>
        <div class="right"><span class="chip">Ø³Ø¬Ù„</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ P2P -->
      <a class="tile ripple-container" href="index10.html">
        <div class="icon"><span class="ms">vpn_key</span></div>
        <div class="text">
          <div class="title">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ P2P</div>
          <div class="desc">ØªØ­Ù‚Ù‘Ù‚ Ø¨Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù€ID ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
        </div>
        <div class="right"><span class="chip">P2P</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙ‰ -->
      <a class="tile ripple-container" href="index11.html">
        <div class="icon"><span class="ms">forum</span></div>
        <div class="text">
          <div class="title">Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙ‰</div>
          <div class="desc">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ÙˆØ§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª</div>
        </div>
        <div class="right"><span class="chip">ØµÙ†Ø¯ÙˆÙ‚</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù† -->
      <a class="tile ripple-container" href="index13.html" id="tileCreateAnn">
        <div class="icon"><span class="ms">campaign</span></div>
        <div class="text">
          <div class="title">Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù†</div>
          <div class="desc">Ø¥Ø¹Ù„Ø§Ù† Ø¹Ø§Ù… Ø£Ùˆ Ù…ÙˆØ¬Ù‘Ù‡ (UID/AccountID)</div>
        </div>
        <div class="right"><span class="chip chip-accent">Ø¥Ø¹Ù„Ø§Ù†</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª -->
      <a class="tile ripple-container" href="index14.html" id="tileAccounts">
        <div class="icon"><span class="ms">manage_accounts</span></div>
        <div class="text">
          <div class="title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</div>
          <div class="desc">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ø¶Ø¨Ø·</div>
        </div>
        <div class="right"><span class="chip">Ø¥Ø¯Ø§Ø±Ø©</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- âœ… Ø²Ø± ØªÙˆÙ‚ÙŠÙ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª (Ù†ÙÙ‚Ù„ Ø¥Ù„Ù‰ Ù‡Ù†Ø§) -->
      <a class="tile ripple-container" href="index15.html" id="tileSuspend">
        <div class="icon"><span class="ms">block</span></div>
        <div class="text">
          <div class="title">ØªÙˆÙ‚ÙŠÙ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</div>
          <div class="desc">Ø¥ÙŠÙ‚Ø§Ù/ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø¨Ø³Ø±Ø¹Ø©</div>
        </div>
        <div class="right"><span class="chip">ØªØ­ÙƒÙ…</span><span class="ms">chevron_left</span></div>
      </a>

      <!-- âœ… Ø²Ø± Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª (Ù†ÙÙ‚Ù„ Ø¥Ù„Ù‰ Ù‡Ù†Ø§) -->
      <a class="tile ripple-container" href="index16.html" id="tileTrash">
        <div class="icon"><span class="ms">delete_sweep</span></div>
        <div class="text">
          <div class="title">Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª</div>
          <div class="desc">Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©</div>
        </div>
        <div class="right"><span class="chip">Ø³Ø¬Ù„</span><span class="ms">chevron_left</span></div>
      </a>

    </section>
  </main>

  <!-- Ø²Ø± Ø·Ø§ÙÙ Ø«Ø§Ø¨Øª Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù† -->
  <a class="fab ripple-container" href="index13.html" id="fabCreateAnn" title="Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù†">
    <span class="ms">campaign</span>
  </a>
  <div class="fab-label">Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù†</div>

  <div id="toast"></div>

  <!-- âœ… Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø«ÙŠÙ… -->
  <div class="theme-modal" id="themeModal" aria-hidden="true">
    <div class="theme-panel" role="dialog" aria-modal="true" aria-label="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø«ÙŠÙ…">
      <div class="theme-head">
        <div class="t">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Â· Ø§Ù„Ø«ÙŠÙ…</div>
        <button class="btn" id="closeTheme" title="Ø¥ØºÙ„Ø§Ù‚"><span class="ms">close</span></button>
      </div>

      <div class="theme-body">
        <div class="theme-opt" data-theme="light" id="optLight">
          <div class="l"><span class="ms">light_mode</span><span>ÙØ§ØªØ­</span></div>
          <span class="b"></span>
        </div>

        <div class="theme-opt" data-theme="dark" id="optDark">
          <div class="l"><span class="ms">dark_mode</span><span>Ø¯Ø§ÙƒÙ†</span></div>
          <span class="b"></span>
        </div>
      </div>

      <div class="theme-foot">
        <button class="theme-btn" id="resetTheme"><span class="ms">restart_alt</span> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</button>
      </div>
    </div>
  </div>

  <!-- Ripple Ø¨Ø³ÙŠØ· -->
  <script>
    document.addEventListener('click', e=>{
      const host = e.target.closest('.ripple-container'); if(!host) return;
      const r = document.createElement('span');
      const d = Math.max(host.clientWidth, host.clientHeight);
      const rect = host.getBoundingClientRect();
      r.className='ripple';
      r.style.width=r.style.height=d+'px';
      r.style.left=(e.clientX-rect.left-d/2)+'px';
      r.style.top=(e.clientY-rect.top-d/2)+'px';
      const old=host.querySelector('.ripple'); if(old) old.remove();
      host.appendChild(r); setTimeout(()=>r.remove(),600);
    });

    // Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
    document.getElementById('refreshBtn').onclick = ()=>location.reload();
    document.getElementById('helpBtn').onclick    = ()=>alert('Ø§ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: index1â€¦index10 + index11.html (Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙ‰). Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù†: index13.html.');

    // âœ… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø«ÙŠÙ… (ØªØ·Ø¨ÙŠÙ‚ + Ø­ÙØ¸)
    (function(){
      const KEY = "main_theme_choice";
      const html = document.documentElement;

      const modal = document.getElementById("themeModal");
      const settingsBtn = document.getElementById("settingsBtn");
      const closeBtn = document.getElementById("closeTheme");
      const resetBtn = document.getElementById("resetTheme");
      const optLight = document.getElementById("optLight");
      const optDark  = document.getElementById("optDark");

      function setActive(theme){
        [optLight,optDark].forEach(x=>x.classList.remove("active"));
        if(theme === "dark") optDark.classList.add("active");
        else optLight.classList.add("active");
      }

      function applyTheme(theme){
        if(theme === "dark") html.setAttribute("data-theme","dark");
        else html.setAttribute("data-theme","light");
        localStorage.setItem(KEY, theme);
        setActive(theme);
      }

      function open(){
        modal.classList.add("show");
        modal.setAttribute("aria-hidden","false");
      }
      function close(){
        modal.classList.remove("show");
        modal.setAttribute("aria-hidden","true");
      }

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ù…Ø­ÙÙˆØ¸
      const saved = localStorage.getItem(KEY) || "light";
      applyTheme(saved);

      settingsBtn.addEventListener("click", open);
      closeBtn.addEventListener("click", close);
      modal.addEventListener("click", (e)=>{ if(e.target === modal) close(); });

      optLight.addEventListener("click", ()=>applyTheme("light"));
      optDark.addEventListener("click",  ()=>applyTheme("dark"));

      resetBtn.addEventListener("click", ()=>{
        localStorage.removeItem(KEY);
        applyTheme("light");
      });
    })();

    // Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± ØªÙ„Ù…ÙŠØ­ Ø§Ù„Ù€ FAB Ø­Ø³Ø¨ Ø§Ù„ØªÙ…Ø±ÙŠØ±
    (function(){
      const label = document.querySelector('.fab-label');
      if(!label) return;
      let lastY = window.scrollY;
      window.addEventListener('scroll', ()=>{
        const now = window.scrollY;
        const down = now > lastY;
        label.style.opacity = down ? '0' : '1';
        label.style.transform = down ? 'translateY(6px)' : 'translateY(0)';
        lastY = now;
      }, {passive:true});
    })();
  </script>

  <!-- Firebase compat -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>

  <!-- Ø±Ø¨Ø· Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ù†ÙØ³ Ù…Ù†Ø·Ù‚ ØµÙØ­ØªÙƒ Ø§Ù„Ù…Ø±Ø¨ÙˆØ·Ø©) -->
  <script>
  (function(){
    const $ = s=>document.querySelector(s);

    /* Firebase */
    const firebaseConfig = {
      apiKey: "AIzaSyBr3mtTHa_nJajn9H5N1V5sWNHIHY8RU8g",
      authDomain: "dynex-f4486.firebaseapp.com",
      databaseURL: "https://dynex-f4486-default-rtdb.firebaseio.com",
      projectId: "dynex-f4486",
      storageBucket: "dynex-f4486.firebasestorage.app"
    };
    if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    /* Ø¥Ø¹Ø¯Ø§Ø¯ */
    const AUTO_REFRESH_MS = 10000;
    function toast(m){
      const t=$("#toast"); if(!t) return;
      t.textContent=m; t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'), 1200);
    }

    /* Helpers */
    const now = ()=> Date.now();
    const last48Start = ()=> now() - 48*60*60*1000;
    const last90Start = ()=> now() - 90*24*60*60*1000;
    const safeLen = o => (o ? Object.keys(o).length : 0);
    const num = v => { const n=Number(v); return (isNaN(n)||!isFinite(n))?NaN:n; };

    function getUserName(u, fallbackId){
      return (
        u?.name ?? u?.fullName ?? u?.displayName ?? u?.realname ?? u?.nickname ?? u?.username ??
        (u?.accountId ? ('Ø­Ø³Ø§Ø¨ ' + u.accountId) : (fallbackId || 'â€”'))
      );
    }
    function getUserIdDisplay(u, uid){
      if(u?.username) return '@'+u.username;
      if(u?.phone) return u.phone;
      if(u?.accountId || u?.accountID || u?.accId) return String(u.accountId||u.accountID||u.accId);
      return uid;
    }
    function getUserTs(u){
      if(!u) return 0;
      const candidates = [u.created_ts, u.createdTs, u.createdAt, u.created_at, u.signupAt, u.joinedAt, u.time, u.at];
      for(const c of candidates){
        if(typeof c === 'number'){
          if(c > 1e11) return c;
          if(c > 1e9)  return c*1000;
        }else if(typeof c === 'string'){
          const n = num(c);
          if(!isNaN(n)){
            if(n > 1e11) return n;
            if(n > 1e9)  return n*1000;
          }
          const t = Date.parse(c);
          if(!isNaN(t)) return t;
        }
      }
      return 0;
    }
    async function getPathAny(paths){
      for(const p of paths){
        try{ const s=await db.ref(p).get(); if(s.exists()) return {path:p, data:s.val()}; }catch(_){}
      }
      return {path:paths[0], data:null};
    }

    /* Queries */
    async function loadUsers(){
      const snap = await db.ref('users').get().catch(()=>null);
      const users = (snap && snap.exists()) ? snap.val() : {};
      const total = safeLen(users);

      const all = [], fresh = [];
      const start48 = last48Start();

      for(const id in users){
        const u = users[id]||{};
        const ts = getUserTs(u);
        const name = getUserName(u, id);
        const disp = getUserIdDisplay(u, id);
        const item = {
          id, name: name || 'â€”', idtxt: disp || id,
          ts: ts || 0,
          tsLocal: ts ? new Date(ts).toLocaleString('ar-EG', { hour12:false }) : 'â€”'
        };
        all.push(item);
        if(ts && ts >= start48) fresh.push(item);
      }

      all.sort((a,b)=> b.ts - a.ts);
      fresh.sort((a,b)=> b.ts - a.ts);

      const showList = fresh.length ? fresh : all.slice(0, 100);
      const mode = fresh.length ? 'fresh' : 'fallback';

      return { total, fresh48:fresh, showList, mode };
    }

    async function loadDeposits(){
      const {data:deps1} = await getPathAny(['deposits']);
      const {data:deps2} = await getPathAny(['deposits_unlinked']);
      const start = last90Start();

      let count=0;
      const uniq = new Set();

      if(deps1){
        Object.keys(deps1).forEach(uid=>{
          const items = deps1[uid]||{};
          Object.keys(items).forEach(k=>{
            const d = items[k]||{};
            let t = num(d.createdAt);
            if(isNaN(t)){
              t = num(d.clientTime);
              if(isNaN(t)){
                const parsed = Date.parse(d.created_at||d.createdAt||d.time||d.at||'');
                t = isNaN(parsed)? NaN : parsed;
              }
            }
            if(!isNaN(t) && t>=start){ count++; if(uid) uniq.add(String(uid)); }
          });
        });
      }
      if(deps2){
        Object.keys(deps2).forEach(k=>{
          const d = deps2[k]||{};
          let t = num(d.createdAt);
          if(isNaN(t)){
            t = num(d.clientTime);
            if(isNaN(t)){
              const parsed = Date.parse(d.created_at||d.createdAt||d.time||d.at||'');
              t = isNaN(parsed)? NaN : parsed;
            }
          }
          if(!isNaN(t) && t>=start){ count++; if(d.uid) uniq.add(String(d.uid)); }
        });
      }
      return { count90:count, unique90:uniq.size };
    }

    async function loadWithdrawals(){
      const {data:w1} = await getPathAny(['withdrawals','withdraws','payouts']);
      const start = last90Start();
      let count=0;
      if(w1){
        const keys = Object.keys(w1);
        const firstKey = keys.length ? keys[0] : null;
        const firstVal = firstKey ? w1[firstKey] : null;
        const nested = firstVal && typeof firstVal === 'object' && !('created_ts' in firstVal) && !('created_at' in firstVal) && !('time' in firstVal);
        if(nested){
          Object.keys(w1).forEach(uid=>{
            const items=w1[uid]||{};
            Object.keys(items).forEach(k=>{
              const r=items[k]||{};
              const t = r.created_ts ?? num(r.createdAt) ?? Date.parse(r.created_at||r.time||r.at||'');
              if(!isNaN(t) && t>=start) count++;
            });
          });
        }else{
          Object.keys(w1).forEach(k=>{
            const r = w1[k]||{};
            const t = r.created_ts ?? num(r.createdAt) ?? Date.parse(r.created_at||r.time||r.at||'');
            if(!isNaN(t) && t>=start) count++;
          });
        }
      }
      return { count90:count };
    }

    async function loadLocked(){
      const {data:l1} = await getPathAny(['balance_to_locked','balance-to-locked','locked_entries','constraints_locked']);
      return { total: safeLen(l1||{}) };
    }

    async function loadTransfers(){
      const {data:t1} = await getPathAny(['transfers','transfers_all','p2p_transfers']);
      if(!t1) return { total:0 };
      let total=0;
      const keys = Object.keys(t1);
      const firstKey = keys.length ? keys[0] : null;
      const firstVal = firstKey ? t1[firstKey] : null;
      const nested = firstVal && typeof firstVal === 'object' && !('id' in firstVal) && !('amount' in firstVal) && !('from' in firstVal) && !('to' in firstVal);
      if(nested){
        Object.keys(t1).forEach(uid=>{
          total += safeLen(t1[uid]);
        });
      }else{
        total = safeLen(t1);
      }
      return { total };
    }

    /* Render */
    function renderMetrics(U,D,W,L,T){
      const box = $("#metrics");
      const empty=$("#empty1");
      if(!box || !empty) return;
      box.innerHTML = '';

      const rows = [
        { icon:'groups', title:'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', primary: U.total.toLocaleString('ar-EG'), extra:'â€”' },
        {
          icon:'trending_up',
          title:(U.mode==='fresh'?'Ø¬Ø¯Ø¯ Ø®Ù„Ø§Ù„ 48 Ø³Ø§Ø¹Ø©':'Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¬Ø¯Ø¯ Ø®Ù„Ø§Ù„ 48 Ø³Ø§Ø¹Ø©)'),
          primary: (U.mode==='fresh'? U.fresh48.length : U.showList.length).toLocaleString('ar-EG'),
          extra: (U.total ? (((U.mode==='fresh'? U.fresh48.length : U.showList.length)*100/U.total).toFixed(1)+'%') : '0%')
        },
        { icon:'account_balance', title:'Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª (Ø¢Ø®Ø± 90 ÙŠÙˆÙ…)', primary: D.count90.toLocaleString('ar-EG'), extra: 'Ù…ÙˆØ¯Ø¹ÙŠÙ† ÙØ±ÙŠØ¯ÙŠÙ†: ' + D.unique90.toLocaleString('ar-EG') },
        { icon:'payments', title:'Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª (Ø¢Ø®Ø± 90 ÙŠÙˆÙ…)', primary: W.count90.toLocaleString('ar-EG'), extra:'â€”' },
        { icon:'account_tree', title:'Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø±ØµÙŠØ¯ â†’ Ø§Ù„Ø¹Ù‚Ø¯', primary: L.total.toLocaleString('ar-EG'), extra:'ÙƒÙ„ Ø§Ù„ÙˆÙ‚Øª' },
        { icon:'sync_alt', title:'Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª', primary: T.total.toLocaleString('ar-EG'), extra:'ÙƒÙ„ Ø§Ù„ÙˆÙ‚Øª' }
      ];

      rows.forEach(r=>{
        const d=document.createElement('div');
        d.className='row';
        d.innerHTML = `
          <span class="ms">${r.icon}</span>
          <span class="name">${r.title}</span>
          <span class="sep">Â·</span>
          <span class="amt">${r.primary}</span>
          <span class="sep">Â·</span>
          <span class="badge">${r.extra}</span>
        `;
        box.appendChild(d);
      });

      empty.style.display = rows.length ? 'none' : 'block';
    }

    function renderNewUsers(list){
      const box = $("#newUsers");
      const empty=$("#empty2");
      const newCount=$("#newCount");
      if(!box || !empty || !newCount) return;

      box.innerHTML = '';
      if(!list.length){ empty.style.display='block'; newCount.textContent='0'; return; }
      empty.style.display='none';
      newCount.textContent = list.length.toLocaleString('ar-EG');

      list.slice(0,100).forEach(u=>{
        const d=document.createElement('div');
        d.className='row';
        d.innerHTML = `
          <span class="ms">person</span>
          <span class="name" title="${u.name}">${u.name}</span>
          <span class="sep">Â·</span>
          <span class="idtxt">${u.idtxt||'-'}</span>
          <span class="sep">Â·</span>
          <span class="time">${u.tsLocal}</span>
          <span class="sep">Â·</span>
          <span class="badge">Ø¬Ø¯ÙŠØ¯</span>
        `;
        box.appendChild(d);
      });
    }

    /* Load All */
    async function loadAll(showToast){
      try{
        const [U,D,W,L,T] = await Promise.all([
          loadUsers(), loadDeposits(), loadWithdrawals(), loadLocked(), loadTransfers()
        ]);
        renderMetrics(U,D,W,L,T);
        renderNewUsers(U.showList);
        if(showToast) toast('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«');
      }catch(e){
        console.error(e);
        toast('ØªØ¹Ø°Ù‘Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª');
      }
    }

    // Ø£ÙˆÙ„ ØªØ´ØºÙŠÙ„ + ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ
    loadAll(false);
    setInterval(()=>loadAll(false), AUTO_REFRESH_MS);
  })();
  </script>

  <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
      .then(reg => console.log("âœ” Service Worker registered"))
      .catch(err => console.error("âŒ Service Worker failed:", err));
  }
  </script>
</body>
</html>